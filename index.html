<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Secretary - Automate Your Business Administration</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .main-dashboard {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #f0f0f0;
        }

        .nav-tab {
            padding: 15px 30px;
            background: none;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 10px 10px 0 0;
            margin: 0 5px;
        }

        .nav-tab.active {
            color: #667eea;
            background: linear-gradient(135deg, rgba(102,126,234,0.1), rgba(118,75,162,0.1));
            border-bottom: 3px solid #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        /* Chat Interface Styles */
        .chat-container {
            height: 600px;
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .chat-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .chat-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .chat-info h3 {
            margin: 0;
            font-size: 1.3rem;
        }

        .chat-info p {
            margin: 5px 0 0 0;
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .chat-status {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #4CAF50;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9ff;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 80%;
            padding: 15px 20px;
            border-radius: 20px;
            position: relative;
            animation: messageSlide 0.3s ease;
        }

        @keyframes messageSlide {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.ai {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }

        .message.user {
            background: white;
            color: #333;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .message-time {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 5px;
        }

        .typing-indicator {
            display: none;
            align-self: flex-start;
            padding: 15px 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 20px;
            border-bottom-left-radius: 5px;
            color: white;
            max-width: 80px;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: white;
            opacity: 0.4;
            animation: typingDot 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typingDot {
            0%, 60%, 100% { opacity: 0.4; }
            30% { opacity: 1; }
        }

        .chat-input-container {
            padding: 20px;
            background: white;
            border-top: 1px solid #e0e7ff;
        }

        .chat-input-wrapper {
            display: flex;
            gap: 15px;
            align-items: flex-end;
        }

        .chat-input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e0e7ff;
            border-radius: 25px;
            font-size: 1rem;
            resize: none;
            min-height: 50px;
            max-height: 120px;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .chat-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
        }

        .chat-send-btn {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .chat-send-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102,126,234,0.3);
        }

        .chat-send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .quick-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .quick-action-btn {
            padding: 8px 16px;
            background: rgba(102,126,234,0.1);
            border: 1px solid rgba(102,126,234,0.2);
            border-radius: 20px;
            color: #667eea;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .quick-action-btn:hover {
            background: rgba(102,126,234,0.2);
            transform: translateY(-1px);
        }

        /* Analytics Styles (keeping existing) */
        .analytics-section {
            background: rgba(102,126,234,0.1);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .section-header {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
            color: #333;
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 25px;
        }

        .input-section h3,
        .results-section h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .input-grid {
            display: grid;
            gap: 15px;
        }

        .input-group label {
            color: #555;
            display: block;
            margin-bottom: 5px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #ddd;
            background: white;
            color: #333;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
        }

        .cost-result {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
            border: 1px solid #e0e7ff;
        }

        .cost-result h4 {
            margin-bottom: 10px;
            font-size: 1rem;
            color: #333;
        }

        .cost-amount {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
        }

        .cost-description {
            color: #666;
            margin-top: 5px;
            font-size: 0.9rem;
        }

        .human-cost { border-left: 4px solid #ff6b6b; }
        .ai-cost { border-left: 4px solid #4CAF50; }
        .savings-highlight {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }

        .savings-highlight h4,
        .savings-highlight .cost-amount {
            color: white;
        }

        .savings-highlight .cost-description {
            color: rgba(255,255,255,0.9);
        }

        .breakdown-details {
            margin-top: 20px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #e0e7ff;
        }

        .breakdown-details h4 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .considerations-section {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            border: 1px solid #e0e7ff;
        }

        .considerations-section h4 {
            color: #333;
            margin-bottom: 15px;
        }

        .considerations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            color: #666;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            border: 1px solid #e0e7ff;
            transition: transform 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
        }

        .metric-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .metric-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 20px;
            color: white;
        }

        .roi-icon { background: linear-gradient(135deg, #4CAF50, #45a049); }
        .time-icon { background: linear-gradient(135deg, #2196F3, #1976D2); }
        .task-icon { background: linear-gradient(135deg, #FF9800, #F57C00); }
        .efficiency-icon { background: linear-gradient(135deg, #9C27B0, #7B1FA2); }

        .metric-title {
            color: #333;
            font-weight: 600;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            color: #333;
            margin: 10px 0;
        }

        .metric-change {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85rem;
            margin-bottom: 15px;
        }

        .positive { color: #4CAF50; }

        .metric-bar {
            width: 100%;
            height: 6px;
            background: #f0f0f0;
            border-radius: 3px;
            overflow: hidden;
        }

        .metric-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .export-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .export-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        @media (max-width: 768px) {
            .calculator-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .metric-value {
                font-size: 1.5rem;
            }

            .chat-container {
                height: 500px;
            }

            .message {
                max-width: 90%;
            }

            .nav-tab {
                padding: 10px 15px;
                font-size: 0.9rem;
            }

            .quick-actions {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🤖 AI Secretary</h1>
            <p>Automate your business administration and eliminate routine tasks</p>
        </div>

        <div class="main-dashboard">
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="switchTab('dashboard')">Dashboard</button>
                <button class="nav-tab" onclick="switchTab('integrations')">Integrations</button>
                <button class="nav-tab" onclick="switchTab('automations')">Automations</button>
                <button class="nav-tab" onclick="switchTab('tasks')">Tasks</button>
                <button class="nav-tab" onclick="switchTab('chat')">AI Assistant</button>
                <button class="nav-tab" onclick="switchTab('analytics')">Analytics</button>
            </div>

            <!-- Dashboard Tab -->
            <div class="tab-content active" id="dashboard">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">47</div>
                        <div class="stat-label">Tasks Automated Today</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">8.2h</div>
                        <div class="stat-label">Time Saved This Week</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">94%</div>
                        <div class="stat-label">Admin Tasks Automated</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">12</div>
                        <div class="stat-label">Active Integrations</div>
                    </div>
                </div>
                <h3 style="margin-bottom: 20px; color: #333;">Recent Activity</h3>
                <p style="color: #666; padding: 20px; background: #f8f9ff; border-radius: 10px;">Dashboard content - all your recent AI automation activity will appear here.</p>
            </div>

            <!-- Integrations Tab -->
            <div class="tab-content" id="integrations">
                <h3 style="margin-bottom: 20px; color: #333;">Connect Your Business Tools</h3>
                <p style="color: #666; padding: 20px; background: #f8f9ff; border-radius: 10px;">Integration settings and connected services will appear here.</p>
            </div>

            <!-- Automations Tab -->
            <div class="tab-content" id="automations">
                <h3 style="margin-bottom: 20px; color: #333;">AI Automation Rules</h3>
                <p style="color: #666; padding: 20px; background: #f8f9ff; border-radius: 10px;">Your automation rules and workflows will be configured here.</p>
            </div>

            <!-- Tasks Tab -->
            <div class="tab-content" id="tasks">
                <h3 style="margin-bottom: 20px; color: #333;">Today's AI-Generated Tasks</h3>
                <p style="color: #666; padding: 20px; background: #f8f9ff; border-radius: 10px;">AI-generated tasks and priorities will be listed here.</p>
            </div>

            <!-- Chat Tab -->
            <div class="tab-content" id="chat">
                <div class="chat-container">
                    <div class="chat-header">
                        <div class="chat-avatar">🤖</div>
                        <div class="chat-info">
                            <h3>AI Secretary Assistant</h3>
                            <p>Ready to help automate your business tasks</p>
                        </div>
                        <div class="chat-status">
                            <div class="status-dot"></div>
                            <span>Online</span>
                        </div>
                    </div>

                    <div class="chat-messages" id="chatMessages">
                        <div class="message ai">
                            <div>👋 Hello! I'm your AI Secretary Assistant. I'm here to help you automate administrative tasks, manage your schedule, handle emails, and streamline your business operations.</div>
                            <div class="message-time">Just now</div>
                        </div>
                        <div class="message ai">
                            <div>What would you like me to help you with today? I can assist with scheduling, email management, document creation, task automation, and much more!</div>
                            <div class="message-time">Just now</div>
                        </div>
                    </div>

                    <div class="typing-indicator" id="typingIndicator">
                        <div class="typing-dots">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>

                    <div class="chat-input-container">
                        <div class="quick-actions">
                            <button class="quick-action-btn" onclick="sendQuickMessage('Schedule a meeting')">📅 Schedule Meeting</button>
                            <button class="quick-action-btn" onclick="sendQuickMessage('Help with email management')">📧 Email Help</button>
                            <button class="quick-action-btn" onclick="sendQuickMessage('Create a document')">📄 Create Document</button>
                            <button class="quick-action-btn" onclick="sendQuickMessage('Set up automation')">⚡ Setup Automation</button>
                        </div>
                        <div class="chat-input-wrapper">
                            <textarea 
                                class="chat-input" 
                                id="chatInput" 
                                placeholder="Type your message here..."
                                rows="1"
                                onkeydown="handleKeyPress(event)"
                                oninput="autoResize(this)"></textarea>
                            <button class="chat-send-btn" id="sendBtn" onclick="sendMessage()">
                                ➤
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div class="tab-content" id="analytics">
                <div class="analytics-section">
                    <div class="section-header">💼 Human Secretary vs AI Cost Calculator</div>
                    <div class="calculator-grid">
                        
                        <!-- Input Section -->
                        <div class="input-section">
                            <h3>📝 Enter Your Secretary Costs</h3>
                            <div class="input-grid">
                                <div class="input-group">
                                    <label>Annual Salary ($)</label>
                                    <input type="number" id="salary" value="55000" onchange="calculateCosts()">
                                </div>
                                <div class="input-group">
                                    <label>Health Insurance ($)</label>
                                    <input type="number" id="insurance" value="8500" onchange="calculateCosts()">
                                </div>
                                <div class="input-group">
                                    <label>Superannuation (%)</label>
                                    <input type="number" id="super" value="11" step="0.1" onchange="calculateCosts()">
                                </div>
                                <div class="input-group">
                                    <label>Annual Leave Days</label>
                                    <input type="number" id="annual-leave" value="20" onchange="calculateCosts()">
                                </div>
                                <div class="input-group">
                                    <label>Average Sick Days</label>
                                    <input type="number" id="sick-leave" value="8" onchange="calculateCosts()">
                                </div>
                                <div class="input-group">
                                    <label>Other Benefits ($)</label>
                                    <input type="number" id="benefits" value="3200" placeholder="Training, equipment, etc." onchange="calculateCosts()">
                                </div>
                            </div>
                        </div>

                        <!-- Results Section -->
                        <div class="results-section">
                            <h3>💰 Cost Comparison Results</h3>
                            
                            <div class="cost-result human-cost">
                                <h4>👤 Human Secretary Total Cost</h4>
                                <div class="cost-amount" id="human-total">$73,250</div>
                                <div class="cost-description" id="human-breakdown">Available 89.2% of year (232 working days)</div>
                            </div>
                            
                            <div class="cost-result ai-cost">
                                <h4>🤖 AI Secretary Annual Cost</h4>
                                <div class="cost-amount" id="ai-total">$3,588</div>
                                <div class="cost-description">Business Plan × 12 months</div>
                            </div>
                            
                            <div class="cost-result savings-highlight">
                                <h4>💎 Your Annual Savings</h4>
                                <div class="cost-amount" id="savings-total">$69,662</div>
                                <div class="cost-description" id="savings-percentage">95.1% cost reduction</div>
                            </div>

                            <div class="breakdown-details">
                                <h4>📊 Detailed Analysis</h4>
                                <div id="cost-breakdown">
                                    <!-- Breakdown will be populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="considerations-section">
                        <h4>🎯 Strategic Considerations</h4>
                        <div class="considerations-grid">
                            <div>
                                <strong style="color: #4CAF50;">✅ AI Advantages:</strong><br>
                                • 24/7 availability (no leave)<br>
                                • Zero sick days or absences<br>
                                • Instant scaling capabilities<br>
                                • No training or onboarding costs<br>
                                • Consistent performance
                            </div>
                            <div>
                                <strong style="color: #FF9800;">⚠️ Human Value:</strong><br>
                                • Personal relationships<br>
                                • Complex problem solving<br>
                                • Physical presence when needed<br>
                                • Emotional intelligence<br>
                                • Adaptability to unique situations
                            </div>
                            <div>
                                <strong style="color: #2196F3;">💡 Hybrid Approach:</strong><br>
                                • Use AI for routine tasks<br>
                                • Keep human for strategic work<br>
                                • Consider part-time human role<br>
                                • Best of both worlds<br>
                                • Gradual transition strategy
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Metrics Dashboard -->
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon roi-icon">💰</div>
                            <div class="metric-title">Monthly Savings</div>
                        </div>
                        <div class="metric-value" id="total-roi">$5,805</div>
                        <div class="metric-change positive">↗ Based on your secretary costs</div>
                        <div class="metric-bar">
                            <div class="metric-fill" style="width: 95%"></div>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon time-icon">⏱️</div>
                            <div class="metric-title">Time Saved</div>
                        </div>
                        <div class="metric-value" id="time-saved">1,847 hrs</div>
                        <div class="metric-change positive">↗ +23.2% vs last period</div>
                        <div class="metric-bar">
                            <div class="metric-fill" style="width: 92%"></div>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon task-icon">✅</div>
                            <div class="metric-title">Tasks Automated</div>
                        </div>
                        <div class="metric-value" id="tasks-automated">12,394</div>
                        <div class="metric-change positive">↗ +31.7% vs last period</div>
                        <div class="metric-bar">
                            <div class="metric-fill" style="width: 78%"></div>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon efficiency-icon">⚡</div>
                            <div class="metric-title">Efficiency Score</div>
                        </div>
                        <div class="metric-value" id="efficiency-score">94.2%</div>
                        <div class="metric-change positive">↗ +5.8% vs last period</div>
                        <div class="metric-bar">
                            <div class="metric-fill" style="width: 94%"></div>
                        </div>
                    </div>
                </div>

                <!-- Export Controls -->
                <div class="export-controls">
                    <button class="export-btn" onclick="exportReport('pdf')">
                        📄 Export PDF Report
                    </button>
                    <button class="export-btn" onclick="exportReport('excel')">
                        📊 Export to Excel
                    </button>
                    <button class="export-btn" onclick="scheduleReport()">
                        📅 Schedule Reports
                    </button>
                    <button class="export-btn" onclick="shareReport()">
                        📤 Share Dashboard
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Chat functionality
        let messageCount = 0;

        function switchTab(tabName, clickedTab) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all tabs
            const navTabs = document.querySelectorAll('.nav-tab');
            navTabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            clickedTab.classList.add('active');
            
            // Initialize analytics if analytics tab is opened
            if (tabName === 'analytics') {
                setTimeout(calculateCosts, 100);
            }

            // Focus chat input if chat tab is opened
            if (tabName === 'chat') {
                setTimeout(() => {
                    document.getElementById('chatInput').focus();
                }, 100);
            }
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addMessage(message, 'user');
            
            // Clear input
            input.value = '';
            input.style.height = 'auto';
            
            // Show typing indicator
            showTypingIndicator();
            
            // Simulate AI response after delay
            setTimeout(() => {
                hideTypingIndicator();
                generateAIResponse(message);
            }, 1000 + Math.random() * 2000);
        }

        function sendQuickMessage(message) {
            document.getElementById('chatInput').value = message;
            sendMessage();
        }

        function addMessage(content, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            messageDiv.innerHTML = `
                <div>${content}</div>
                <div class="message-time">${time}</div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            messageCount++;
        }

        function showTypingIndicator() {
            const indicator = document.getElementById('typingIndicator');
            indicator.style.display = 'block';
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function hideTypingIndicator() {
            const indicator = document.getElementById('typingIndicator');
            indicator.style.display = 'none';
        }

        function generateAIResponse(userMessage) {
            const responses = getContextualResponse(userMessage.toLowerCase());
            const response = responses[Math.floor(Math.random() * responses.length)];
            addMessage(response, 'ai');
        }

        function getContextualResponse(message) {
            if (message.includes('schedule') || message.includes('meeting') || message.includes('calendar')) {
                return [
                    "I'd be happy to help you schedule a meeting! I can integrate with your calendar system to find available times, send invitations, and set up recurring meetings. What type of meeting would you like to schedule?",
                    "📅 Perfect! I can help you manage your calendar efficiently. I can check availability, book meeting rooms, send automated reminders, and even prepare meeting agendas. When would you like to schedule this?",
                    "Let me assist with your scheduling needs! I can coordinate with multiple attendees, find optimal meeting times, and handle all the logistics. What's the purpose and duration of your meeting?"
                ];
            }
            
            if (message.includes('email') || message.includes('mail')) {
                return [
                    "📧 I'm excellent at email management! I can help you sort emails by priority, draft responses, set up auto-replies, create email templates, and even manage your inbox organization. What specific email task can I help with?",
                    "Email automation is one of my specialties! I can filter spam, categorize important messages, schedule email sending, and create professional templates. How would you like me to streamline your email workflow?",
                    "I can transform your email management! From smart sorting to automated responses, I'll help you achieve inbox zero. I can also draft emails in your style and manage follow-ups. What's your biggest email challenge?"
                ];
            }
            
            if (message.includes('document') || message.includes('report') || message.includes('create')) {
                return [
                    "📄 I can help you create professional documents! Whether it's reports, proposals, invoices, or presentations, I can generate content, format documents, and ensure consistency. What type of document do you need?",
                    "Document creation is something I excel at! I can draft contracts, create templates, generate reports from data, and maintain your document library. What document would you like me to help you with?",
                    "Let me assist with your document needs! I can create everything from simple letters to complex reports, ensure proper formatting, and maintain version control. What's the purpose of the document you need?"
                ];
            }
            
            if (message.includes('automation') || message.includes('automate') || message.includes('workflow')) {
                return [
                    "⚡ Automation is my core strength! I can set up workflows that handle repetitive tasks, integrate different systems, and create rules that work 24/7. What processes would you like me to automate?",
                    "I love setting up automations! From simple task reminders to complex multi-step workflows, I can streamline your entire operation. What repetitive tasks are taking up too much of your time?",
                    "Workflow automation can save you hours every day! I can connect your tools, create triggers and actions, and handle routine processes automatically. Which area of your business needs automation first?"
                ];
            }
            
            if (message.includes('cost') || message.includes('save') || message.includes('money') || message.includes('roi')) {
                return [
                    "💰 Based on our cost calculator, businesses typically save 90-95% on administrative costs by switching to AI automation. You could save thousands annually while getting 24/7 availability and consistent performance!",
                    "The ROI on AI automation is incredible! Most of my clients see payback within the first month. No sick days, no vacation time, no benefits costs - just reliable, efficient service. Would you like me to calculate your specific savings?",
                    "Cost savings are just the beginning! Beyond the 95% reduction in secretary costs, you'll gain productivity, consistency, and scalability. Your business can grow without proportionally increasing administrative overhead."
                ];
            }
            
            if (message.includes('help') || message.includes('what can you') || message.includes('capabilities')) {
                return [
                    "I'm your complete AI business assistant! I can handle scheduling, email management, document creation, data analysis, customer service, social media posting, invoice processing, and much more. What's your biggest administrative challenge?",
                    "My capabilities span across all business administration: 📅 Calendar management, 📧 Email automation, 📄 Document creation, 📊 Data processing, 🤝 Customer communications, and ⚡ Workflow automation. How can I help streamline your operations?",
                    "Think of me as your 24/7 business partner! I can manage your daily operations, handle customer inquiries, process data, create content, manage social media, and automate repetitive tasks. What would you like to tackle first?"
                ];
            }
            
            // Default responses
            return [
                "That's a great question! I'm here to help automate your business processes and save you time. Could you tell me more about what specific task or challenge you're facing?",
                "I'd love to help you with that! As your AI secretary, I can handle a wide range of administrative tasks. What would you like me to focus on first?",
                "Excellent! I'm designed to streamline business operations and eliminate repetitive tasks. What area of your business could benefit most from automation?",
                "I'm ready to assist! Whether it's scheduling, communications, document management, or process automation, I'm here to make your business more efficient. What can I help you with?",
                "Perfect! I specialize in business automation and administrative support. From email management to workflow optimization, I'm here to help. What's your priority right now?"
            ];
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
        }

        // Analytics functionality (keeping existing)
        function calculateCosts() {
            const salary = parseFloat(document.getElementById('salary').value) || 0;
            const insurance = parseFloat(document.getElementById('insurance').value) || 0;
            const superRate = parseFloat(document.getElementById('super').value) || 0;
            const annualLeave = parseInt(document.getElementById('annual-leave').value) || 0;
            const sickLeave = parseInt(document.getElementById('sick-leave').value) || 0;
            const benefits = parseFloat(document.getElementById('benefits').value) || 0;

            const superAmount = salary * (superRate / 100);
            const totalWorkDays = 260;
            const daysOff = annualLeave + sickLeave;
            const workingDays = Math.max(totalWorkDays - daysOff, 1);
            const availabilityPercentage = (workingDays / totalWorkDays) * 100;

            const humanTotal = salary + insurance + superAmount + benefits;
            const aiTotal = 299 * 12;
            const savings = Math.max(humanTotal - aiTotal, 0);
            const savingsPercentage = humanTotal > 0 ? (savings / humanTotal) * 100 : 0;

            updateElement('human-total', ' + humanTotal.toLocaleString());
            updateElement('human-breakdown', 'Available ' + availabilityPercentage.toFixed(1) + '% of year (' + workingDays + ' working days)');
            updateElement('ai-total', ' + aiTotal.toLocaleString());
            updateElement('savings-total', ' + savings.toLocaleString());
            updateElement('savings-percentage', savingsPercentage.toFixed(1) + '% cost reduction');

            const monthlySavings = savings / 12;
            updateElement('total-roi', ' + Math.round(monthlySavings).toLocaleString());

            updateBreakdown(salary, insurance, superAmount, benefits, daysOff, humanTotal, workingDays, aiTotal, savings);
        }

        function updateElement(id, value) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = value;
            }
        }

        function updateBreakdown(salary, insurance, superAmount, benefits, daysOff, humanTotal, workingDays, aiTotal, savings) {
            const costPerDay = humanTotal > 0 && workingDays > 0 ? (humanTotal / workingDays).toFixed(2) : '0.00';
            const aiCostPerDay = (aiTotal / 365).toFixed(2);
            const breakEvenDays = savings > 0 ? (aiTotal / (savings / 365)).toFixed(1) : 'N/A';
            
            const breakdown = 
                '<strong>Human Secretary Breakdown:</strong><br>' +
                '• Base Salary:  + salary.toLocaleString() + '<br>' +
                '• Health Insurance:  + insurance.toLocaleString() + '<br>' +
                '• Superannuation:  + Math.round(superAmount).toLocaleString() + '<br>' +
                '• Other Benefits:  + benefits.toLocaleString() + '<br>' +
                '• Total Leave: ' + daysOff + ' days per year<br><br>' +
                '<strong>Daily Cost Analysis:</strong><br>' +
                '• Human cost per working day:  + costPerDay + '<br>' +
                '• AI cost per day:  + aiCostPerDay + ' (24/7 available)<br>' +
                '• Break-even timeline: ' + breakEvenDays + ' days';
            
            const element = document.getElementById('cost-breakdown');
            if (element) {
                element.innerHTML = breakdown;
            }
        }

        function exportReport(format) {
            alert('Exporting ' + format.toUpperCase() + ' report with your personalized cost analysis...');
        }

        function scheduleReport() {
            alert('Opening report scheduling interface... Set up automated delivery of your ROI reports.');
        }

        function shareReport() {
            alert('Opening share options... Generate shareable links or export summaries for stakeholders.');
        }

        // Initialize chat on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-calculate costs on page load
            calculateCosts();
        });
    </script>
</body>
</html>
